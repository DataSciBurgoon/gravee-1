# Test data sets for testing gravee package -----

# Data of logCPMs with entrez identifiers and unordered columns
# Used for:
#   1. Are data parsed correctly?
test_data_logcpm <- "entrezid	133	314	133	314	171	171	0	261.5	209	209	171	0	209	0	261.5	133	314	0	261.5
100333514	0.217231075	0.309053032	-0.204653899	1.150229579	0.210995533	0.201136895	-4.125835652	0.785846448	0.835924137	-0.191054482	0.572270789	-4.125835652	0.376931508	-4.125835652	-0.15553362	-1.54389558	-0.385810362	-4.125835652	0.804542606
393611	7.139493914	7.087350751	6.603137823	7.207090467	6.875736782	6.901684515	5.024190338	7.087429809	7.29026106	6.780886151	7.17780461	5.786152201	6.97454556	4.847515461	7.291699532	6.841934741	6.963325405	4.740694029	7.332253218
335495	5.321590805	5.794517194	5.365351799	5.949752026	5.502065645	5.694366773	4.581573545	5.675547404	5.627990482	5.11839314	5.96080306	4.891791642	5.242018656	4.48836849	5.60679028	5.397366832	5.653055657	4.508669473	5.626728742
100002108	3.462344565	3.103404574	3.22922692	3.079414142	2.995060819	3.52348383	1.204332412	3.306979338	3.75585502	3.388321989	3.376851003	1.717949478	3.579016045	1.930367349	3.406239385	3.463635313	3.609549329	1.890877698	3.455994463
564159	3.172389004	3.042637539	3.814718901	3.451756776	3.293714288	3.965590533	6.109371042	3.174980708	3.596300286	3.605710921	3.636682993	4.497551524	3.286396168	5.758923003	2.934976113	3.727475801	3.205535643	5.393938719	2.987702915
100286774	4.297221139	3.625980223	4.195864307	3.853977086	3.735618245	3.590427099	5.649519023	3.017150979	3.458128458	2.604737015	3.35977698	5.068404708	3.637075315	6.346784821	3.529120713	3.968143174	3.841013852	6.292120076	3.445576856
798694	4.535261733	4.10741799	4.600199967	4.449721063	3.795358719	4.263850166	1.966400623	4.646293583	4.737151061	3.793716713	4.416814268	2.397735965	4.133746995	1.637816687	4.088714779	4.095481023	4.29022533	1.995207395	4.757383236
100149130	1.650885709	1.441437041	1.234871292	1.350113123	1.638495719	1.725498852	4.296556628	1.369829291	1.366281429	2.173424773	1.634712809	2.677018709	1.277630612	3.718570956	1.200798123	1.507234302	1.26609009	3.84571289	0.621690028
563152	-1.106354644	2.093977133	-1.76775258	0.065939882	-0.872339031	0.936764923	-3.648374728	0.213545314	-0.892243992	-1.049916515	1.313171795	-2.441904302	-1.028291931	-3.157321624	-1.272771014	-1.447073335	-0.884305872	-4.125835652	0.200171944
335409	3.915904336	4.880193012	3.614481122	4.211612311	3.80980512	4.301525123	1.437638404	4.403364691	4.313505668	3.496928466	4.739138173	2.662649653	3.004443277	2.001205953	4.007055896	3.309349461	3.928358174	1.568960681	4.433113158"

test_data_logcpm <- read.table(text = test_data_logcpm, sep = "\t", header = T, check.names = F)

# Test data uplaoded from the original GRAVEE repository -----
# Test data 1 used for:
#   1. Are data parsed correctly?
#   2. Does calculate_pod_calculation remove assays with not enough observations?
test_data_1 <- "Assay	0.10	0.50	1.0	5	10	50	100	500
blah x	0.001	0.002	0.002	0.005	0.007	2.1	10	100"

test_data_1 <- read.table(text = test_data_1, sep = "\t", header = T, check.names = F)

# Test data adapted from test_data_2
# Test that Assay 'blah x' is retained, but 'blah y' is removed
# due to only one observation per dose.
test_data_removes <- "Assay	0.10	0.50	1.0	5	10	50	100	500
blah x	0.001	0.002	0.002	0.005	0.007	2.1	11	100
blah x	0.002	0.003	0.001	0.002	0.005	2.5	13	101
blah x	0.001	NA	NA	NA	NA	NA	NA	110
blah y	2	NA	NA	0.005	0.1	NA	NA	NA
blah y	NA	1	NA	NA	NA	NA	2	100
blah y	NA	NA	0.1	0.005	14	NA	NA	100
"

test_data_removes <- read.table(text = test_data_removes, sep = "\t", header = T, check.names = F)

# Test data adapted from test_data_2
# Test that Assay "blah y" is removed due to too few doses
test_data_doses <- "Assay	0.10	0.50	1.0	5	10	50	100	500
blah x	0.001	0.002	0.002	0.005	0.007	2.1	11	100
blah x	0.002	0.003	0.001	0.002	0.005	2.5	13	101
blah x	0.001	NA	NA	NA	NA	NA	NA	110
blah y	NA	NA	NA	0.005	NA	NA	NA	100
blah y	NA	NA	NA	0.005	NA	NA	NA	100
blah y	NA	NA	NA	0.005	NA	NA	NA	100
"

test_data_doses <- read.table(text = test_data_doses, sep = "\t", header = T, check.names = F)

# Test data adapted from test_data_1
# Tests that blah x is removed due to too few doses for interpolation.
test_data_doses_error <- "Assay	0.10	0.50
blah x	0.001	0.002
blah x	0.002	0.003
blah x	0.001	0.002
"

test_data_doses_error <- read.table(text = test_data_doses_error, sep = "\t", header = T, check.names = F)

# Test data adapted from test_data_tnt
# Assays values are not unique, so we can get an expected
# POD estimate.
test_data_duplicate <- "name	0	0.3125	0.625	1.25	2.5	5
ACSM2B	10.7082217300384	11.7377226694966	11.6204489520133	10.4787696194758	10.0247933847025	9.0389189892923
ACSM2B	10.7082217300384	11.7377226694966	11.6204489520133	10.4787696194758	10.0247933847025	9.0389189892923
ACSM2B	10.7082217300384	11.7377226694966	11.6204489520133	10.4787696194758	10.0247933847025	9.0389189892923
ACSM2B	10.7082217300384	11.7377226694966	11.6204489520133	10.4787696194758	10.0247933847025	9.0389189892923
"

test_data_duplicate <- read.table(text = test_data_duplicate, sep = "\t", header = T, check.names = F)

# Test data adapted from test_data_tnt
# Does it work on more than 1 assay?
test_data_more_duplicate <- "name	0	0.3125	0.625	1.25	2.5	5
ACSM2B	10.7082217300384	11.7377226694966	11.6204489520133	10.4787696194758	10.0247933847025	9.0389189892923
ACSM2B	10.7082217300384	11.7377226694966	11.6204489520133	10.4787696194758	10.0247933847025	9.0389189892923
ACSM2D	20.7082217300384	2.7377226694966	4.6204489520133	0.4787696194758	10.0247933847025	0.0389189892923
ACSM2D	20.7082217300384	2.7377226694966	4.6204489520133	0.4787696194758	10.0247933847025	0.0389189892923
"

test_data_more_duplicate <- read.table(text = test_data_more_duplicate, sep = "\t", header = T, check.names = F)

# Test data adapted from test_data_logcpm
# Create format with one gene per row...
test_data_reformat <- "entrezid	133	314	133	314	171	171	0	261.5	209	209	171	0	209	0	261.5	133	314	0	261.5
563152	-1.106354644	2.093977133	-1.106354644	2.093977133	-0.872339031	-0.872339031	-3.648374728	0.213545314	-0.892243992	-0.892243992	-0.872339031	-3.648374728	-0.892243992	-3.648374728	0.213545314	-1.106354644	2.093977133	-3.648374728	0.213545314
335409	3.915904336	4.880193012	3.915904336	4.880193012	3.80980512	3.80980512	1.437638404	4.403364691	4.313505668	4.313505668	3.80980512	1.437638404	4.313505668	1.437638404	4.403364691	3.915904336	4.880193012	1.437638404	4.403364691"

test_data_reformat <- read.table(text = test_data_reformat, sep = "\t", header = T, check.names = F)
